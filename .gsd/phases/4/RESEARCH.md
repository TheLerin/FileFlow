# Phase 4 Research: Client-Side Document Data Extraction

**Topic:** Parsing `xlsx`, `csv`, and `docx` securely in a browser.

## Key Discoveries
1. **Spreadsheets (xlsx/csv):** 
   - `SheetJS` (installed via `npm install xlsx`) is the absolute leader in this. It allows `XLSX.read(arrayBuffer)` and export utilities like `XLSX.utils.sheet_to_csv()`, `XLSX.utils.sheet_to_json()`, and `XLSX.writeFile()`.
   - Native blob download can just be generated by SheetJS. It's completely synchronous and fast for small/medium files.
2. **Word Documents (docx):**
   - Rendering full `.docx` in the browser with styles aligned is incredibly difficult and heavily bloated due to Microsoft's complex XML rules.
   - However, **Mammoth.js** (`npm install mammoth`) is explicitly built for HTML/Text extraction. It takes a `.docx` array buffer and outputs clean, semantic HTML or raw `\n` text strings.
   - This aligns perfectly with our roadmap constraints (no complex office rendering, just data conversion).

## Architecture Decision
- Wave 1: Install `xlsx` and build the 3 spreadsheet converters mapping ArrayBuffers using `XLSX.read()`.
- Wave 2: Install `mammoth` and build the 2 text extraction tools. Provide raw `File` parsing loops and string blobs.
